{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["\r\nimport SimpleLightbox from 'simplelightbox';\r\nimport 'simplelightbox/dist/simple-lightbox.min.css';\r\n\r\n\r\nconst galleryListEl = document.querySelector(\".gallery\");\r\nconst lightbox = new SimpleLightbox('.gallery a', {\r\n  captionsData: 'title',\r\n  captionDelay: 250,\r\n  });\r\n\r\nconst createGalleryItemEl = (image) => {\r\n    return `\r\n        <li class=\"gallery-item\">\r\n        <a class=\"gallery-link\" href=${image.largeImageURL}>\r\n            <img\r\n            class=\"gallery-image\"\r\n            src=\"${image.previewURL}\"\r\n            alt=\"${image.tags}\"\r\n            title=\"Likes \\n ${image.likes} Views \\n ${image.views} Comments \\n ${image.comments} Downloads \\n ${image.downloads}\"\r\n            />\r\n        </a>\r\n        </li>\r\n        `;\r\n}\r\n\r\nexport function createGallery(images) {\r\n    const galleryArr = images.map(el => createGalleryItemEl(el)).join('');\r\n    galleryListEl.insertAdjacentHTML('beforeend', galleryArr);\r\n\r\n    lightbox.refresh();\r\n}\r\n","export function createUrl(keyword, page = 1) {\r\n    const options = {\r\n        baseUrl: \"https://pixabay.com/api/\",\r\n        apiKey: '50902999-34d3d718e1412684e61a556a9',\r\n        query: keyword,\r\n        imageType: \"photo\",\r\n        orientation: \"hohorizontal\",\r\n        safesearch: true,\r\n        perPage: 15,\r\n        page: page\r\n    }\r\n    \r\n    const url = new URL(options.baseUrl);\r\n    url.search = new URLSearchParams({\r\n        key: options.apiKey,\r\n        q: options.query,\r\n        imageType: options.imageType,\r\n        orientation: options.orientation,\r\n        safesearch: options.safesearch,\r\n        per_page: options.perPage,\r\n        page: options.page,\r\n    }).toString();\r\n\r\n    return url;\r\n}","import iziToast from \"izitoast\";\r\nimport \"izitoast/dist/css/iziToast.min.css\";\r\nimport SimpleLightbox from 'simplelightbox';\r\nimport 'simplelightbox/dist/simple-lightbox.min.css';\r\nimport axios from 'axios';\r\nimport { createGallery } from './js/render-functions.js';\r\nimport { createUrl } from \"./js/pixabay-api.js\";\r\n\r\n\r\nconst refs = {\r\n    formEl: document.querySelector('.form'),\r\n    formInputEl: document.querySelector('.form-input-key-word'),\r\n    formBtnEl: document.querySelector('.search-btn'),\r\n    formLoadMoreBtn: document.querySelector('.load-more-btn'),\r\n    galleryListEl: document.querySelector(\".gallery\"),\r\n    loaderEl: document.querySelector('.loader'),\r\n} \r\n\r\nlet currentPage = 1;\r\nlet keyWord = '';\r\n\r\nrefs.formLoadMoreBtn.addEventListener('click', () => {\r\n    handleLoadMoreBtnClick(keyWord);\r\n});\r\n\r\nasync function handleSubmit(event) {\r\n    event.preventDefault();\r\n    keyWord = event.target.elements.keyword.value.trim();\r\n    console.log(keyWord);\r\n\r\n    if (keyWord === '') {\r\n        iziToast.warning({\r\n            title: 'Caution',\r\n            message: 'No keyword to start search',\r\n            position: 'topRight',\r\n          }); \r\n        return;\r\n    }\r\n\r\n    refs.loaderEl.classList.remove('hidden');\r\n\r\n    const url = createUrl(keyWord, currentPage);\r\n\r\n    try {\r\n        const response = await axios.get(url);\r\n        const data = response.data;\r\n        console.log(data);\r\n        console.log(data.totalHits);\r\n        refs.galleryListEl.innerHTML = '';\r\n\r\n\r\n        if (data.total === 0) {\r\n            aiziToast.warning({\r\n                title: 'Caution',\r\n                message: 'Any image matches with given keyword.',\r\n                position: 'topRight',\r\n            });\r\n            refs.loaderEl.classList.add('hidden');\r\n            return;\r\n          }\r\n      \r\n          if (data.totalHits > 1) {\r\n            refs.formLoadMoreBtn.classList.remove('hidden');\r\n          }\r\n\r\n        createGallery(data.hits);\r\n        \r\n    } catch (error) {\r\n        console.error(error);\r\n    } finally {\r\n        refs.loaderEl.classList.add('hidden');\r\n        refs.formEl.reset();\r\n    }\r\n}\r\n\r\nrefs.formEl.addEventListener('submit', handleSubmit);\r\n\r\nasync function handleLoadMoreBtnClick(keyWord) {\r\n    console.log('Click LoadMore Button');\r\n    try {\r\n        currentPage = currentPage + 1;\r\n        const url = createUrl(keyWord, currentPage);\r\n        const response = await axios.get(url);\r\n        const data = response.data;\r\n        console.log(data);\r\n        console.log(currentPage);\r\n        createGallery(data.hits);\r\n\r\n        const {height: cardHeight} = document.querySelector('.gallery').firstElementChild.getBoundingClientRect();\r\n        console.log(cardHeight);\r\n\r\n        window.scrollBy({\r\n            top: cardHeight * 2,\r\n            behavior: \"smooth\",\r\n          });\r\n\r\n        if (currentPage * 15 >= data.totalHits) {\r\n            refs.formLoadMoreBtn.classList.add('hidden');\r\n            iziToast.info({\r\n                title: 'Caution',\r\n                message: \"We're sorry, but you've reached the end of search results.\",\r\n                position: 'topRight',\r\n              }); \r\n        }\r\n    } catch (err) {\r\n        console.error(error);\r\n    }\r\n}"],"names":["galleryListEl","lightbox","SimpleLightbox","createGalleryItemEl","image","createGallery","images","galleryArr","el","createUrl","keyword","page","options","url","refs","currentPage","keyWord","handleLoadMoreBtnClick","handleSubmit","event","iziToast","data","axios","error","cardHeight"],"mappings":"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"}